Простое и гибкое ядро для управления глобальными состояниями игры (меню, игра, поражение, победа) в Unity.

* * *

**Основные возможности**
------------------------

**Централизованное управление состояниями** игры

**Автоматическое обнаружение** сервисов, реагирующих на смену состояния

**Плавные переходы** между состояниями без конфликтов

**Гибкое расширение** через интерфейс `IStateService`

**Синглтон-паттерн** для глобального доступа

**Настройка времени, курсора и других параметров** для каждого состояния

* * *

**Как использовать**
--------------------

**Подключите GameManager к сцене**
----------------------------------

Создайте пустой GameObject и добавьте компонент `GameManager`

Назначьте ScriptableObject'ы для каждого состояния:

`Menu Data` — состояние меню

`Game Play Data` — состояние игры

`Game Over Data` — состояние поражения

`Win Data` — состояние победы

### **Создайте сервис, реагирующий на состояния**

Любой MonoBehaviour может стать сервисом, реализовав интерфейс `IStateService`:

`public class MyService : MonoBehaviour, IStateService
{
    public void OnEnter(GameStateDataSO state)
    {
        Debug.Log($"Вошли в состояние: {state.type}");
    }
    public void OnUpdate(GameStateDataSO state)
    {
        // Вызывается каждый кадр в текущем состоянии
    }
    public void OnExit(GameStateDataSO state)
    {
        Debug.Log($"Выходим из состояния: {state.type}");
    }
}`

### **Переключайте состояния в коде**

`GameManager.Instance.StartGame();   // Начать игру`
`GameManager.Instance.GameOver();    // Поражение`
`GameManager.Instance.WinGame();     // Победа`
`GameManager.Instance.GoToMenu();    // Вернуться в меню`
* * *

**Структура GameStateDataSO**
-----------------------------

Каждое состояние содержит:

`type` — тип состояния (enum)

`timeScale` — масштаб времени (0 = пауза, 1 = нормально)

`cursorMode` — режим курсора (Locked, Confined, None)

`cursorVisible` — видимость курсора

* * *

**Автоматическое переподключение сервисов**
-------------------------------------------

Если вы динамически добавляете или удаляете сервисы во время работы игры, вызовите:

`GameManager.Instance.ReloadServices();`

* * *

**Важные заметки**
------------------

GameManager автоматически помечается как `DontDestroyOnLoad`

Все сервисы должны быть активными (`activeInHierarchy`) и включёнными (`enabled`)

Переходы защищены от повторных вызовов (`isTransitioning`)

Если состояние не назначено — будет выведена ошибка

* * *

**Пример использования**
------------------------

`// В любом месте кода
if (player.Health <= 0)
{
    GameManager.Instance.GameOver();
}
// Получить текущее состояние
var state \= GameManager.Instance.GetCurrentState();
if (state.type \== GameStateType.Menu)
{
    // Делаем что-то только в меню
}`

* * *

**Для разработчиков**
---------------------

Добавьте свои состояния через создание новых `GameStateDataSO`

Расширяйте функциональность через новые сервисы

Используйте `ReloadServices()` при динамической загрузке сцен
